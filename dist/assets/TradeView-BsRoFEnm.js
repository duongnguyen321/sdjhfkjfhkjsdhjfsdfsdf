import{l as D}from"./bank-BfU8Rxvi.js";import{a as Q}from"./index-CdjHlNDK.js";import{l as U}from"./coin-DsvuaeH_.js";import{a as W,l as E}from"./trade-DsKlzW2O.js";import{l as x}from"./vietqr-CwIEdr8u.js";import{_ as z,b as q,E as R,a as V,c as m,d as s,t as l,e as a,w as i,l as G,v as I,F as y,r as p,h,o as d,m as N,i as _,n as A,g as C,f as B}from"./index-QQhhOUTB.js";import{l as O}from"./evaluate-B-3Bvy2i.js";const $=Q.create({baseURL:"https://api.vietqr.io/v2",headers:{"Content-Type":"application/json"}}),j=async()=>{try{return(await $.get("/banks")).data}catch(e){throw new Error(e.response.data.message||e.message)}},K="/assets/icon-ti-gia-BVZWuAam.png",P="/assets/icon-search-BtfciZ4B.png",Z="/assets/icon-star-wjTNTTDW.png",H="/assets/icon-service-Ow0HK5IZ.png",J={data(){return{baseImg:q,formBuy:{Total:1,QuantityBuy:null,Money:null,Code:"",Address:"",Bank:"",NumberBank:"",binBank:""},showMenuBuy:!0,showFormBuy:!0,code:"",formSell:{Quantity:null,Bank:"",NumberBank:null,NameBank:"",Money:null,Total:null,Code:""},listBankVietQR:[],checkBank:!1,isLoadingCheckBank:!1,listBankAdmin:[],dataListCoin:[],coinChoise:"",dataCreateTrade:{idCoin:"",nameCoin:"",unitCoin:"",quantity:0,walletAddress:"",qrCoin:"",userName:"",accountNumber:"",bankName:"",bankAccount:"",moneyTrade:0,transactionFees:0,oderStatus:1,tradeStatus:3,tradingCode:""},windowWidth:window.innerWidth,dataEvaluate:[],dataWeb:{}}},created(){this.callApiGetListBank(),this.callApiGetListBankAdmin(),this.callApiGetListCoin(),this.callApiGetListEvaluate(),this.getSettingWeb()},mounted(){window.addEventListener("resize",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize)},methods:{showNotify(){R({title:"Custom Position",message:"I'm at the bottom left corner",position:"bottom-left"})},getSettingWeb(){this.dataWeb=JSON.parse(V.get("web")),console.log("data web",this.dataWeb)},handleResize(){this.windowWidth=window.innerWidth},setupBinBank(){this.formBuy.binBank=this.listBankAdmin.find(e=>e._id===this.formBuy.Bank).bin},handleSell(){this.formSell.Money=this.formSell.Quantity*this.coinChoise.moneySell},handleMoney(){this.formBuy.Money=this.formBuy.QuantityBuy*this.coinChoise.moneyBuy},setDataForm(){this.formBuy={...this.formBuy,Total:this.coinChoise.quantity}},checkCoinChoise(e){return e._id===this.coinChoise._id&&this.showFormBuy===this.showMenuBuy},choiseCoin(e,o){switch(this.coinChoise=e,o){case"Buy":this.showFormBuy=!0,this.formBuy={...this.formBuy,Total:this.coinChoise.quantity};break;case"Sell":this.showFormBuy=!1;break}},formatCurrency(e){return`${e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")} VND`},callApiGetListEvaluate(){O().then(e=>{this.dataEvaluate=e})},callApiGetListCoin(){U().then(e=>{this.dataListCoin=e,this.coinChoise=e[0],this.setDataForm()})},callApiGetListBankAdmin(){D().then(e=>{this.listBankAdmin=e})},callApiGetListBank(){j().then(e=>{this.listBankVietQR=e.data})},submitForm(){var e=JSON.parse(V.get("user"));this.dataCreateTrade={...this.dataCreateTrade,idCoin:this.coinChoise._id,nameCoin:this.coinChoise.name,unitCoin:this.coinChoise.unit,quantity:this.showFormBuy?this.formBuy.QuantityBuy:this.formSell.Quantity,walletAddress:this.showFormBuy?this.formBuy.Address:this.coinChoise.walletAddress,qrCoin:this.showFormBuy?"":this.coinChoise.qrCoin,userName:e.username,idUser:e.userId,binBank:this.showFormBuy?this.formBuy.binBank:"",accountNumber:this.showFormBuy?this.listBankAdmin.find(o=>o._id===this.formBuy.Bank).accountNumber:this.formSell.NumberBank,bankName:this.showFormBuy?this.listBankAdmin.find(o=>o._id===this.formBuy.Bank).name:this.formSell.Bank,bankAccount:this.showFormBuy?this.listBankAdmin.find(o=>o._id===this.formBuy.Bank).userName:this.formSell.NameBank,moneyTrade:this.showFormBuy?this.formBuy.Money:this.formSell.Money,transactionFees:this.showFormBuy?this.coinChoise.serviceChargeBuy:this.coinChoise.serviceChargeSell,oderStatus:this.showFormBuy?1:2,tradeStatus:3,tradingCode:"",exchangeRate:this.showFormBuy?this.coinChoise.moneyBuy:this.coinChoise.moneySell},W(this.dataCreateTrade).then(o=>{this.$router.push({path:"/transaction",query:{id:o._id}})})},changeShow(e){this.showMenuBuy=e},validBan(){return!(this.formSell.Quantity&&this.formSell.Bank&&this.formSell.NumberBank&&this.checkBank)},logoBankSelect(e){return this.listBankVietQR.find(o=>o.id===e).logo},checkName(){this.formSell.NameBank="",this.isLoadingCheckBank=!0;const e=this.listBankVietQR.find(o=>o.id===this.formSell.Bank);x(e.bin,this.formSell.NumberBank).then(o=>{this.formSell.NameBank=o.data.accountName,this.checkBank=!0,this.isLoadingCheckBank=!1,this.formSell.Total=this.listBankAdmin[0].bankBalance}).catch(()=>{this.formSell.NameBank=`Không tìm thấy STK ${e.code} này, vui lòng thử lại.`,this.checkBank=!1,this.isLoadingCheckBank=!1})},async searchOrder(){await E({tradingCode:this.code}).then(e=>{this.$router.push({path:"/transaction",query:{id:e._id}})}).catch(()=>{this.$message.error("Không tồn tại mã đơn hàng này, vui lòng kiểm tra lại")})}}},X={class:"over"},Y={class:"container pb-4"},ee={class:"warning mt-8"},te={class:"over__container"},se={class:"menu__left"},oe={class:"form__new"},le={class:"header__form"},ne=s("img",{src:K,alt:"ti-gia",class:"w-5 h-5"},null,-1),ae={class:"text-xl font-bold"},ie={class:"text-lg mb-2 mt-6"},re={class:"flex flex-col gap-3 mt-4"},de=["onClick"],ue={class:"flex gap-2 items-center"},me=["src","alt"],he={class:"font-medium"},ce={class:"money__buy"},_e=["onClick"],fe={class:"flex gap-2 items-center"},ye=["src","alt"],pe={class:"font-medium"},Be={class:"money__sell"},be={class:"content"},ke={key:0},Ce={class:"form__trade"},ge={class:"info__trade"},we={class:"flex w-full"},ve={class:"textUnit"},Se={style:{"font-size":"12px",color:"#d9534f","font-style":"italic","font-weight":"700"}},Ve={style:{"font-size":"12px",color:"#d9534f","font-style":"italic","font-weight":"700"}},Ne={class:"transaction__instructions rounded"},Ae={class:"text-sm font-medium"},Te={class:"text__manual"},Fe={class:"text__manual"},Me={class:"text__manual"},Le={class:"text__manual"},De={class:"text__manual"},Qe={key:1},Ue={class:"form__trade"},We={class:"info__trade"},Ee={class:"flex justify-between items-center"},xe=["src","alt"],ze={style:{float:"left"}},qe={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},Re=["src","alt"],Ge={key:0},Ie={class:"transaction__instructions rounded"},Oe={class:"text-sm font-medium"},$e={class:"text__manual"},je={class:"text__manual"},Ke={class:"text__manual"},Pe={class:"text__manual"},Ze={class:"text__manual"},He={class:"menu__left"},Je={class:"form__new"},Xe={class:"header__form"},Ye=s("img",{src:P,alt:"giao-dich",class:"w-5 h-5"},null,-1),et={class:"text-xl font-bold"},tt={class:"flex flex-col gap-3 mt-8 text-sm"},st={class:"flex flex-col"},ot=["placeholder"],lt={class:"form__new"},nt={class:"header__form"},at=s("img",{src:Z,alt:"giao-dich",class:"w-5 h-5"},null,-1),it={class:"text-xl font-bold"},rt={class:"flex flex-col gap-3 mt-8 text-sm content__fb"},dt={class:"item__danh--gia"},ut={class:"text-base font-medium"},mt={class:"form__new"},ht={class:"header__form"},ct=s("img",{src:H,alt:"support",class:"w-5 h-5"},null,-1),_t={class:"text-xl font-bold"},ft={class:"flex flex-col gap-3 mt-4 text-sm"},yt={style:{"font-size":"13px"}},pt={class:"my-4 font-bold"},Bt={style:{color:"#5f9ea0"},class:"font-bold"};function bt(e,o,kt,Ct,n,r){const f=h("el-button"),b=h("el-col"),T=h("el-row"),c=h("el-input"),u=h("el-form-item"),F=h("el-input-number"),g=h("el-option"),w=h("el-select"),v=h("el-form"),M=h("Loading"),S=h("el-icon"),L=h("Check");return d(),m("div",X,[s("div",Y,[s("div",ee,l(this.dataWeb.tradeNote),1),s("div",te,[s("div",se,[s("div",oe,[s("div",le,[ne,s("p",ae,l(e.$t("trade.exchangeRate")),1)]),s("p",ie,l(e.$t("trade.titleExchange")),1),s("div",null,[a(T,{gutter:10},{default:i(()=>[a(b,{span:12},{default:i(()=>[a(f,{size:"large",onClick:o[0]||(o[0]=t=>r.changeShow(!0)),class:N([n.showMenuBuy?"button__buy":"button__default","w-full"])},{default:i(()=>[_(l(e.$t("trade.buy")),1)]),_:1},8,["class"])]),_:1}),a(b,{span:12},{default:i(()=>[a(f,{size:"large",onClick:o[1]||(o[1]=t=>r.changeShow(!1)),class:N([n.showMenuBuy?"button__default":"button__sell","w-full"])},{default:i(()=>[_(l(e.$t("trade.sell")),1)]),_:1},8,["class"])]),_:1}),a(b,{span:24},{default:i(()=>[s("div",re,[(d(!0),m(y,null,p(n.dataListCoin,t=>(d(),m("div",{key:t._id},[n.showMenuBuy&&t.statusBuy===1?(d(),m("div",{key:0,style:A(r.checkCoinChoise(t)?"background-color: #b5b5b5":""),class:"flex justify-between item__coin",onClick:k=>r.choiseCoin(t,"Buy")},[s("div",ue,[s("img",{class:"w-5 h-5",src:n.baseImg+t.icon,alt:t.name},null,8,me),s("p",he,l(t.name),1)]),s("p",ce,l(r.formatCurrency(t.moneyBuy)),1)],12,de)):C("",!0),!n.showMenuBuy&&t.statusSell===1?(d(),m("div",{key:1,style:A(r.checkCoinChoise(t)?"background-color: #b5b5b5":""),class:"flex justify-between item__coin",onClick:k=>r.choiseCoin(t,"Sell")},[s("div",fe,[s("img",{class:"w-5 h-5",src:n.baseImg+t.icon,alt:t.name},null,8,ye),s("p",pe,l(t.name),1)]),s("p",Be,l(r.formatCurrency(t.moneySell)),1)],12,_e)):C("",!0)]))),128))])]),_:1})]),_:1})])])]),s("div",be,[n.showFormBuy?(d(),m("div",ke,[s("p",null,l(e.$t("trade.buy"))+" "+l(this.coinChoise.name),1),s("div",Ce,[s("div",ge,l(e.$t("trade.noteTrade")),1),s("div",null,[a(v,{"label-width":n.windowWidth<600?"100px":"auto","label-position":n.windowWidth<600?"left":"right",class:"demo-ruleForm mt-6"},{default:i(()=>[a(u,{label:e.$t("trade.weHave")},{default:i(()=>[a(c,{modelValue:n.formBuy.Total,"onUpdate:modelValue":o[2]||(o[2]=t=>n.formBuy.Total=t),autocomplete:"off",disabled:!0},{append:i(()=>[_(l(this.coinChoise.unit),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.quantityBuy")},{default:i(()=>[s("div",we,[a(F,{onChange:o[3]||(o[3]=t=>r.handleMoney()),onBlur:o[4]||(o[4]=t=>r.handleMoney()),modelValue:n.formBuy.QuantityBuy,"onUpdate:modelValue":o[5]||(o[5]=t=>n.formBuy.QuantityBuy=t),placeholder:"VD: 10",controls:!1,class:"inputNumber",min:n.coinChoise.min,max:n.formBuy.Total},null,8,["modelValue","min","max"]),s("div",ve,l(this.coinChoise.unit),1)]),s("div",Se,l(e.$t("trade.noteCoin1"))+" "+l(this.coinChoise.unit)+" "+l(e.$t("trade.noteCoin2"))+" "+l(this.coinChoise.min)+" "+l(e.$t("trade.noteCoin3"))+" "+l(this.formBuy.Total),1)]),_:1},8,["label"]),a(u,{label:e.$t("trade.moneyPaid")},{default:i(()=>[a(c,{modelValue:n.formBuy.Money,"onUpdate:modelValue":o[6]||(o[6]=t=>n.formBuy.Money=t),modelModifiers:{number:!0},disabled:"",formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")},{append:i(()=>[_("VND")]),_:1},8,["modelValue","formatter"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.bankPaid")},{default:i(()=>[a(w,{modelValue:n.formBuy.Bank,"onUpdate:modelValue":o[7]||(o[7]=t=>n.formBuy.Bank=t),placeholder:e.$t("trade.plaBankPaid"),style:{width:"100%"},onChange:r.setupBinBank},{default:i(()=>[(d(!0),m(y,null,p(n.listBankAdmin,t=>(d(),B(g,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","onChange"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.addressCoin")},{default:i(()=>[a(c,{modelValue:n.formBuy.Address,"onUpdate:modelValue":o[8]||(o[8]=t=>n.formBuy.Address=t),modelModifiers:{number:!0},placeholder:"VD: TG26uD8KTDAZm4od8yE9di9kMsXYZ12345"},null,8,["modelValue"]),s("p",Ve,l(e.$t("trade.checkAddressCoin")),1)]),_:1},8,["label"]),a(u,{label:e.$t("trade.codeDiscount")},{default:i(()=>[a(c,{modelValue:n.formBuy.Code,"onUpdate:modelValue":o[9]||(o[9]=t=>n.formBuy.Code=t),modelModifiers:{number:!0},placeholder:e.$t("trade.plaCodeDiscount")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:" "},{default:i(()=>[a(f,{type:"primary",onClick:o[10]||(o[10]=t=>r.submitForm()),disabled:!(n.formBuy.QuantityBuy&&n.formBuy.Address&&n.formBuy.QuantityBuy.length!==0&&n.formBuy.Address.length!==0)},{default:i(()=>[_(l(e.$t("trade.continue")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["label-width","label-position"])]),s("div",Ne,[s("p",Ae,l(e.$t("trade.titleInstruct")),1),s("p",Te,l(e.$t("trade.des1")),1),s("p",Fe,l(e.$t("trade.des2")),1),s("p",Me,l(e.$t("trade.des3")),1),s("p",Le,l(e.$t("trade.des4")),1),s("p",De,l(e.$t("trade.des5")),1)])])])):(d(),m("div",Qe,[s("p",null,l(e.$t("trade.sell"))+" "+l(this.coinChoise.name),1),s("div",Ue,[s("div",We,l(e.$t("trade.noteTrade")),1),s("div",null,[a(v,{"label-width":"auto",class:"demo-ruleForm mt-6"},{default:i(()=>[a(u,{label:e.$t("trade.quantitySell")},{default:i(()=>[a(c,{modelValue:n.formSell.Quantity,"onUpdate:modelValue":o[11]||(o[11]=t=>n.formSell.Quantity=t),autocomplete:"off",placeholder:"VD: 10$",onChange:o[12]||(o[12]=t=>r.handleSell())},{append:i(()=>[_(l(this.coinChoise.unit),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.bankPaid")},{default:i(()=>[a(w,{modelValue:n.formSell.Bank,"onUpdate:modelValue":o[13]||(o[13]=t=>n.formSell.Bank=t),filterable:"",placeholder:e.$t("trade.plaBankTo")},{label:i(({label:t,value:k})=>[s("div",Ee,[s("span",null,l(t),1),s("img",{src:r.logoBankSelect(k),alt:t,class:"w-15 h-7"},null,8,xe)])]),default:i(()=>[(d(!0),m(y,null,p(n.listBankVietQR,t=>(d(),B(g,{key:t.id,label:t.shortName,value:t.id},{default:i(()=>[s("span",ze,l(t.shortName),1),s("span",qe,[s("img",{src:t.logo,alt:t.shortName,class:"w-15 h-8"},null,8,Re)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.numberAccount")},{default:i(()=>[a(c,{modelValue:n.formSell.NumberBank,"onUpdate:modelValue":o[14]||(o[14]=t=>n.formSell.NumberBank=t),placeholder:e.$t("trade.plaNumberAccount"),onBlur:o[15]||(o[15]=t=>r.checkName())},{suffix:i(()=>[n.isLoadingCheckBank?(d(),B(S,{key:0},{default:i(()=>[a(M)]),_:1})):(d(),B(S,{key:1},{default:i(()=>[a(L)]),_:1}))]),_:1},8,["modelValue","placeholder"]),this.isLoadingCheckBank?(d(),m("p",Ge,l(e.$t("trade.titleLoading")),1)):C("",!0)]),_:1},8,["label"]),a(u,{label:e.$t("trade.nameBank")},{default:i(()=>[a(c,{modelValue:n.formSell.NameBank,"onUpdate:modelValue":o[16]||(o[16]=t=>n.formSell.NameBank=t),modelModifiers:{number:!0},disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.moneyReceived")},{default:i(()=>[a(c,{modelValue:n.formSell.Money,"onUpdate:modelValue":o[17]||(o[17]=t=>n.formSell.Money=t),modelModifiers:{number:!0},disabled:"",formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")},{append:i(()=>[_("VND")]),_:1},8,["modelValue","formatter"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.weStillHave")},{default:i(()=>[a(c,{modelValue:n.formSell.Total,"onUpdate:modelValue":o[18]||(o[18]=t=>n.formSell.Total=t),modelModifiers:{number:!0},disabled:"",formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")},{append:i(()=>[_("VND")]),_:1},8,["modelValue","formatter"])]),_:1},8,["label"]),a(u,{label:e.$t("trade.codeDiscount")},{default:i(()=>[a(c,{modelValue:n.formSell.Code,"onUpdate:modelValue":o[19]||(o[19]=t=>n.formSell.Code=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{label:" "},{default:i(()=>[a(f,{type:"primary",onClick:o[20]||(o[20]=t=>r.submitForm()),disabled:r.validBan()},{default:i(()=>[_(" Tiếp tục ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),s("div",Ie,[s("p",Oe,l(e.$t("trade.titleInstruct")),1),s("p",$e,l(e.$t("trade.des1")),1),s("p",je,l(e.$t("trade.des2")),1),s("p",Ke,l(e.$t("trade.des3")),1),s("p",Pe,l(e.$t("trade.des4")),1),s("p",Ze,l(e.$t("trade.des5")),1)])])]))]),s("div",He,[s("div",Je,[s("div",Xe,[Ye,s("p",et,l(e.$t("trade.searchForOrders")),1)]),s("div",tt,[s("div",st,[G(s("input",{class:"input__search","onUpdate:modelValue":o[21]||(o[21]=t=>n.code=t),placeholder:e.$t("trade.plaSearchOrders")},null,8,ot),[[I,n.code]]),s("button",{class:"button__search",onClick:o[22]||(o[22]=(...t)=>r.searchOrder&&r.searchOrder(...t))},l(e.$t("trade.search")),1)])])]),s("div",lt,[s("div",nt,[at,s("p",it,l(e.$t("trade.evaluate")),1)]),s("div",rt,[(d(!0),m(y,null,p(n.dataEvaluate,t=>(d(),m("div",{class:"flex flex-col",key:t._id},[s("div",dt,[s("p",ut,l(t.userName),1),s("p",null,l(t.comment),1)])]))),128))])]),s("div",mt,[s("div",ht,[ct,s("p",_t,l(e.$t("trade.support")),1)]),s("div",ft,[s("div",yt,[s("p",pt,l(e.$t("trade.phone"))+": "+l(this.dataWeb.phone),1),s("p",Bt,l(e.$t("trade.noteSupport")),1)])])])])])])])}const Tt=z(J,[["render",bt]]);export{Tt as default};
